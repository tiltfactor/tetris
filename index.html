<!doctype HTML>
<html>
	<head>
		<meta charset="UTF-8" />
		<title>Spatial Game</title>
		<link rel="stylesheet" href="timeout-dialog.css" type="text/css" media="screen, projection" />
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.12/jquery-ui.min.js"></script>
		<script src = 'timeout-dialog.js' type="text/javascript"></script>

		<style>
			body {
				font-family: sans-serif;
				padding-left: 20px;
				background: #F0F3F4;
			}
			table {
				border-collapse: collapse;
			}
			td {
				padding: 5px;
				border: 1px solid gray;
			}

			#warning{
				font-family: Arial;
				font-size: 20px;
			}


		</style>

	</head>
	<body>

		<h2>Instructions</h2>
		<p>
			In this game, you are trying to arrange the falling blocks to fill each row completely.
			You may move and rotate each piece as it falls. When it reaches the bottom (or another piece)
			it will stay there, and another piece will start to fall. The box to the right of the board
			displays the next piece. 
		</p>
		<p>
			When a row is completely filled, it will be removed from the board. Clear as many lines as
			you can in 5 minutes.
		</p>
		<h2>Controls</h2>
		<table>
			<tr>
				<th>Control</th>
				<th>Action</th>
			</tr>
			<tr>
				<td>Left/right arrows</td>
				<td>Move piece left/right</td>
			</tr>
			<tr>
				<td>Up arrow, X</td>
				<td>Rotate piece clockwise</td>
			</tr>
			<tr>
				<td>Z</td>
				<td>Rotate piece counterclockwise</td>
			</tr>
			<tr>
				<td>Down arrow</td>
				<td>Accelerate piece downwards</td>
			</tr>
			<tr>
				<td>Space</td>
				<td>Immediately drop piece</td>
			</tr>
		</table>
		<p>
			Please note that your gameplay will be recorded for research purposes.
		</p>
		<span id="play-game-link"></span>
		 <div>
  </div>


		<script type="text/javascript">

		var startTime = new Date();
		//send message to screen before showing instructions
		var condition;
		var qualtricsID = "NID";
		var hasCond = false;
		var URL = window.location.href;
		console.log(URL);
		var msg_n = "As you may know, there has been some controversy about whether there are gender differences in spatial ability. The game you are about to play has NOT been shown to produce gender differences.";
		var msg_s = "As you may know, there has been some controversy about whether there are gender differences in spatial ability. The game you are about to play has been shown to produce gender differences.";
		var mymsg;

		// var URL = "tiltfactor1.dartmouth.edu/test/tetris?c=n&variable2=something&variable3=something";
    	if (URL.includes("?")) {
    		var breakURL = URL.split("?");
    		if (breakURL[1].includes("&")) {
    			var variables = breakURL[1].split("&");
    		}
    		else {
    			var variables = [breakURL[1]];
    		}
    	}

    	for (j in variables) {
    		var i = variables[j].split("=");
    		if (i[0] === "qid"){
    			qualtricsID = i[1];
    		}
    		if (i[0] == "c") {
    			condition = i[1];
    			hasCond = true;
    		}
    	}

    	console.log(hasCond);

    	if (hasCond == false)
    		condition = "n";

    	console.log (condition);

    	if (condition == "n")
    		mymsg = msg_n;

    	if (condition == "s")
    		mymsg = msg_s;
    	
    	console.log ("QID is "+qualtricsID);
    	
    	document.getElementById("play-game-link").innerHTML = "Play Game".link("game.html?c="+condition+"&qid="+qualtricsID);

		$.timeoutDialog({timeout: 1, countdown: 20, msg: mymsg});

				
		
		</script>

	</body>
</html>